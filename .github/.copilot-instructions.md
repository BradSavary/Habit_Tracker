# Copilot Instructions - Habit Tracker App

## ğŸ“± Contexte du projet
Vous travaillez sur **Habit Tracker**, une application web mobile-first dÃ©veloppÃ©e avec **Next.js** pour aider les utilisateurs Ã  crÃ©er, suivre et analyser leurs habitudes quotidiennes.

## ğŸ¯ Objectifs principaux
- Offrir une expÃ©rience simple, motivante et personnalisable
- Aider Ã  construire de bonnes routines
- Interface optimisÃ©e pour mobile en prioritÃ© (responsive design)
- ExpÃ©rience utilisateur fluide et intuitive

---

## ğŸ—ï¸ Stack technique

### Framework & Core
- **Framework**: Next.js 15.5.6 (TypeScript 5.x)
- **React**: 19.1.0 + React DOM 19.1.0
- **Build Tool**: Turbopack (Next.js intÃ©grÃ©)
- **Package Manager**: npm

### Styling & UI
- **CSS Framework**: Tailwind CSS v4 (avec @tailwindcss/postcss)
- **SystÃ¨me de design**: shadcn/ui (composants Radix UI)
- **IcÃ´nes**: Lucide React 0.546.0
- **ThÃ¨mes**: next-themes 0.4.6 (dark/light mode)
- **Utility**: 
  - clsx 2.1.1 (conditional classes)
  - tailwind-merge 3.3.1 (merge classes)
  - class-variance-authority 0.7.1 (variants)

### Formulaires & Validation
- **Forms**: React Hook Form 7.65.0
- **Validation**: Zod 4.1.12
- **Resolvers**: @hookform/resolvers 5.2.2

### UI Components (Radix UI)
- **Avatar**: @radix-ui/react-avatar 1.1.10
- **Dialog**: @radix-ui/react-dialog 1.1.15
- **Label**: @radix-ui/react-label 2.1.7
- **Progress**: @radix-ui/react-progress 1.1.7
- **Slot**: @radix-ui/react-slot 1.2.3
- **Switch**: @radix-ui/react-switch 1.2.6
- **Tabs**: @radix-ui/react-tabs 1.1.13

### Utilities & Libraries
- **Date**: date-fns 4.1.0
- **Calendar**: react-day-picker 9.11.1
- **Notifications**: sonner 2.0.7

### Development & Quality
- **Linting**: ESLint 9.x + eslint-config-next 15.5.6
- **TypeScript**: 5.x (Strict mode activÃ©)
- **Dev Tools**: Next.js Dev Tools + Turbopack

### Base de donnÃ©es & ORM
- **BDD**: PostgreSQL (Neon sur Vercel)
- **ORM**: Prisma 6.19.0 (@prisma/client 6.19.0)
- **Config**: dotenv 17.2.3 pour variables d'environnement
- **Migrations**: Prisma Migrate
- **Client singleton**: `/lib/prisma.ts` pour rÃ©utilisation globale

---

## ğŸ¨ Design System & Guidelines

### Tokens sÃ©mantiques (OBLIGATOIRE)
- **RÃˆGLE ABSOLUE** : Utiliser exclusivement les tokens sÃ©mantiques pour toutes les couleurs
- **Interdiction formelle** : Classes Tailwind directes (`bg-white`, `text-black`, `bg-gray-100`, etc.)

#### Background tokens
- `bg-background-100` : Main background (blanc/noir profond)
- `bg-background-200` : Subtle background  
- `bg-background-300` : Cards, sections principales
- `bg-background-400` : Hover states, interactions
- `bg-background-500` : Borders, dividers

#### Foreground tokens
- `text-foreground-100` : Disabled text
- `text-foreground-200` : Placeholder text
- `text-foreground-300` : Secondary text
- `text-foreground-400` : Tertiary text
- `text-foreground-500` : Body text (standard)
- `text-foreground-600` : Headings
- `text-foreground-700` : Emphasis text
- `text-foreground-800` : Primary text
- `text-foreground-900` : High contrast

### Composants UI (shadcn/ui PRIORITÃ‰ ABSOLUE)
- **Principe** : Toujours utiliser shadcn/ui avant toute autre solution
- **Composants installÃ©s** : Button, Input, Card, Dialog, Form, Badge, Progress, Calendar, Switch, Tabs, Toast (Sonner), Avatar
- **Personnalisation** : Via variants et CSS variables uniquement
- **AccessibilitÃ©** : IntÃ©grÃ©e par dÃ©faut dans tous les composants

Si besoin installÃ© d'autre composants Radix UI via shadcn/ui.
---

## ğŸ“± Approche dÃ©veloppement

### Mobile-First (OBLIGATOIRE)
- Conception mobile d'abord (320px+)
- Breakpoints responsive : mobile (320px), tablet (768px), desktop (1024px)
- Interactions tactiles optimisÃ©es
- Performance mobile prioritaire

### Architecture des pages
```
/ - Landing page / connexion rapide
/login - Connexion utilisateur  
/register - Inscription utilisateur
/dashboard - Vue principale (stats, liste d'habitudes)
/habits/[id] - DÃ©tail d'une habitude
/account - Profil et rÃ©glages
```

---

## ğŸ† Roadmap de dÃ©veloppement

### Version 1 - MVP (PrioritÃ© absolue)
1. **Authentification** : NextAuth.js - Inscription/connexion/session/protection routes
2. **Gestion habitudes** : CRUD habitudes avec frÃ©quences et validation
3. **Dashboard** : Vue calendrier + liste du jour
4. **Streaks** : Suivi des sÃ©ries de rÃ©ussite

### Version 2 - AmÃ©liorations
- Personnalisation (icÃ´nes, couleurs, catÃ©gories)
- Mode sombre/clair (next-themes)
- Page dÃ©tail habitude
- Export donnÃ©es

### Version 3 - AvancÃ©
- Notifications intelligentes
- Statistiques avancÃ©es
- Graphiques de progression

---

## ğŸ§© Guidelines techniques

### Conventions de code
- **TypeScript** : Mode strict activÃ©
- **Composants** : React fonctionnels avec hooks uniquement
- **Nommage** : camelCase (JS/TS), kebab-case (CSS)
- **Structure** : Modulaire et rÃ©utilisable
- **Documentation** : Commentaires pour logique complexe

### Architecture Client/Server Components (CRITIQUE)
> **RÃˆGLE FONDAMENTALE** : Chaque choix entre Client et Server Component doit Ãªtre **justifiÃ© et justifiable logiquement**.

#### ğŸ–¥ï¸ Server Components (par dÃ©faut)
**Utiliser TOUJOURS par dÃ©faut**, sauf si besoin explicite d'interactivitÃ© client.

**Quand utiliser** :
- âœ… RÃ©cupÃ©ration de donnÃ©es depuis la BDD (Prisma)
- âœ… AccÃ¨s aux secrets/variables serveur
- âœ… Composants purement statiques (sans interactivitÃ©)
- âœ… OpÃ©rations lourdes cÃ´tÃ© serveur
- âœ… RÃ©duction du bundle JavaScript client

**Exemples justifiÃ©s** :
```typescript
// âœ… Server Component - RÃ©cupÃ¨re des donnÃ©es
export default async function HabitsList({ userId }: { userId: string }) {
  const habits = await prisma.habit.findMany({ where: { userId } })
  return <div>{habits.map(h => <HabitCard key={h.id} habit={h} />)}</div>
}

// âœ… Server Component - Layout statique
export default function DashboardLayout({ children }: { children: React.ReactNode }) {
  return <div className="container">{children}</div>
}
```

#### ğŸ’» Client Components ('use client')
**Utiliser UNIQUEMENT quand nÃ©cessaire** - Doit Ãªtre justifiable.

**Quand utiliser** :
- âœ… Hooks React (useState, useEffect, useContext, etc.)
- âœ… Event handlers (onClick, onChange, onSubmit, etc.)
- âœ… Interactions utilisateur (hover, focus, animations)
- âœ… APIs navigateur (localStorage, window, document)
- âœ… Composants shadcn/ui avec interactivitÃ© (Dialog, Form, Switch, etc.)

**Exemples justifiÃ©s** :
```typescript
// âœ… Client Component - Utilise useState + onClick
'use client'
export function HabitToggle({ habitId }: { habitId: string }) {
  const [completed, setCompleted] = useState(false)
  
  const handleToggle = async () => {
    // Logique d'interaction
    setCompleted(!completed)
  }
  
  return <button onClick={handleToggle}>Toggle</button>
}

// âœ… Client Component - Formulaire avec validation
'use client'
export function CreateHabitForm() {
  const form = useForm() // Hook React Hook Form
  return <form onSubmit={form.handleSubmit(onSubmit)}>...</form>
}
```

#### ğŸ”€ Pattern de composition recommandÃ©
**Maximiser Server, minimiser Client** - Encapsuler le client dans le serveur.

```typescript
// âœ… EXCELLENT - Server Component parent
export default async function HabitsPage() {
  const habits = await getHabits() // Fetch cÃ´tÃ© serveur
  
  return (
    <div>
      <HabitsHeader /> {/* Server Component */}
      <HabitsList habits={habits}> {/* Server Component */}
        {habits.map(habit => (
          <HabitCard key={habit.id} habit={habit}> {/* Server */}
            <HabitToggleButton habitId={habit.id} /> {/* Client uniquement ici */}
          </HabitCard>
        ))}
      </HabitsList>
    </div>
  )
}
```

#### âš ï¸ Erreurs courantes Ã  Ã©viter
```typescript
// âŒ MAUVAIS - Tout en Client alors que pas nÃ©cessaire
'use client'
export default function Dashboard() { // Pas de hooks = pas besoin de client
  return <div>Static content</div>
}

// âŒ MAUVAIS - Fetch dans Client Component
'use client'
export function HabitsList() {
  const [habits, setHabits] = useState([])
  useEffect(() => {
    fetch('/api/habits').then(r => r.json()).then(setHabits) // âŒ
  }, [])
}

// âœ… BON - Fetch dans Server Component
export default async function HabitsList() {
  const habits = await prisma.habit.findMany() // âœ…
  return <div>{habits.map(...)}</div>
}
```

#### ğŸ“‹ Checklist de dÃ©cision

Avant de choisir Client Component, vÃ©rifier :
1. â“ Ai-je besoin de hooks React ? â†’ Oui = Client
2. â“ Ai-je besoin d'event handlers ? â†’ Oui = Client
3. â“ Ai-je besoin d'APIs navigateur ? â†’ Oui = Client
4. â“ Le composant est-il purement statique ? â†’ Oui = Server
5. â“ Puis-je isoler l'interactivitÃ© dans un sous-composant ? â†’ Oui = Faire Ã§a

#### ğŸ¯ RÃ¨gles d'or
- **Par dÃ©faut = Server** : Ne pas ajouter 'use client' sans raison
- **Justification obligatoire** : Tout Client Component doit avoir une raison documentÃ©e
- **GranularitÃ©** : Client Components aussi petits que possible
- **Composition** : Server parent â†’ Client enfant isolÃ©
- **Performance** : Moins de JavaScript client = app plus rapide

### Structure des Skeletons
```
components/Skeletons/
â”œâ”€â”€ base/          # Atomiques (SkeletonCard, SkeletonText, etc.)
â”œâ”€â”€ composed/      # ComposÃ©s (SkeletonHabitCard, SkeletonStatCard)
â””â”€â”€ pages/         # Pages complÃ¨tes (SkeletonDashboard, etc.)
```

### Bonnes pratiques
- **Performance** : SSR, optimisation images, lazy loading
- **AccessibilitÃ©** : a11y pour tous les utilisateurs
- **Progressive Web App** : PWA compatible
- **Loading states** : Feedback utilisateur constant
- **Gestion erreurs** : Gracieuse avec Toast (Sonner) notifications
- **SEO** : Meta tags dynamiques, sitemaps
- **Respect de nextjs** : Suivre les conventions et optimisations recommandÃ©es par la documentation officielle pour cette version

---

## ğŸ”’ SÃ©curitÃ© & Architecture

### Authentification
- **NextAuth.js** : Sessions sÃ©curisÃ©es
- **Protection routes** : Middleware pour pages privÃ©es
- **Validation** : Client ET serveur (Zod)
- **Isolation donnÃ©es** : Par utilisateur

### Standards qualitÃ©
- **ESLint** : Configuration Next.js stricte
- **TypeScript** : Types stricts, pas de `any`
- **Performance** : Core Web Vitals optimisÃ©s
- **Tests** : Ã€ implÃ©menter (Jest + Testing Library)

---

## ğŸ’¡ Rappels critiques

### âœ… Ã€ TOUJOURS faire
- Tester sur mobile en premier
- Utiliser shadcn/ui exclusivement
- Appliquer les tokens sÃ©mantiques pour toutes les couleurs
- **Justifier chaque choix Client/Server Component**
- **PrivilÃ©gier Server Components par dÃ©faut**
- Suivre les prioritÃ©s MVP
- Optimiser pour les interactions tactiles
- Maintenir l'interface simple et motivante
- Documenter le code
- Respecter les conventions Next.js

### âŒ Ã€ JAMAIS faire
- Utiliser des classes de couleur Tailwind directes
- ImplÃ©menter des composants UI custom sans vÃ©rifier shadcn/ui
- **Ajouter 'use client' sans justification logique claire**
- **Faire du fetching de donnÃ©es dans des Client Components**
- **Mettre tout en Client Component par paresse**
- Ignorer l'approche mobile-first
- Ajouter des fonctionnalitÃ©s avancÃ©es avant le MVP
- Utiliser `any` en TypeScript

---

## ğŸ“š Inspiration design
- **SimplicitÃ©** : Streaks app (motivation par sÃ©ries)
- **ProductivitÃ©** : Habitify app (suivi dÃ©taillÃ©)
- **Interface** : Ã‰purÃ©e, motivante, indicateurs visuels clairs

---

## ğŸ”„ Extensions futures
*Section rÃ©servÃ©e pour les ajouts futurs*
- Authentification OAuth
- IntÃ©grations tierces
- Analytics avancÃ©es
- Notifications push