# Copilot Instructions - Habit Tracker App

## üì± Contexte du projet
Vous travaillez sur **Habit Tracker**, une application web mobile-first d√©velopp√©e avec **Next.js** pour aider les utilisateurs √† cr√©er, suivre et analyser leurs habitudes quotidiennes.

## üéØ Objectifs principaux
- Offrir une exp√©rience simple, motivante et personnalisable
- Aider √† construire de bonnes routines
- Interface optimis√©e pour mobile en priorit√© (responsive design)
- Exp√©rience utilisateur fluide et intuitive

---

## üèóÔ∏è Stack technique

### Framework & Core
- **Framework**: Next.js 15.5.6 (TypeScript 5.x)
- **React**: 19.1.0 + React DOM 19.1.0
- **Build Tool**: Turbopack (Next.js int√©gr√©)
- **Package Manager**: npm

### Styling & UI
- **CSS Framework**: Tailwind CSS v4 (avec @tailwindcss/postcss)
- **Syst√®me de design**: shadcn/ui (composants Radix UI)
- **Ic√¥nes**: Lucide React 0.546.0
- **Th√®mes**: next-themes 0.4.6 (dark/light mode)
- **Utility**: 
  - clsx 2.1.1 (conditional classes)
  - tailwind-merge 3.3.1 (merge classes)
  - class-variance-authority 0.7.1 (variants)

### Formulaires & Validation
- **Forms**: React Hook Form 7.65.0
- **Validation**: Zod 4.1.12
- **Resolvers**: @hookform/resolvers 5.2.2

### UI Components (Radix UI)
- **Avatar**: @radix-ui/react-avatar 1.1.10
- **Dialog**: @radix-ui/react-dialog 1.1.15
- **Label**: @radix-ui/react-label 2.1.7
- **Progress**: @radix-ui/react-progress 1.1.7
- **Slot**: @radix-ui/react-slot 1.2.3
- **Switch**: @radix-ui/react-switch 1.2.6
- **Tabs**: @radix-ui/react-tabs 1.1.13
- **Sheet**: Composant de panneau lat√©ral (menu mobile, sidebars)

### Utilities & Libraries
- **Date**: date-fns 4.1.0
- **Calendar**: react-day-picker 9.11.1
- **Notifications**: sonner 2.0.7

### Development & Quality
- **Linting**: ESLint 9.x + eslint-config-next 15.5.6
- **TypeScript**: 5.x (Strict mode activ√©)
- **Dev Tools**: Next.js Dev Tools + Turbopack

### Base de donn√©es & ORM
- **BDD**: PostgreSQL (Neon sur Vercel)
- **ORM**: Prisma 6.19.0 (@prisma/client 6.19.0)
- **Config**: dotenv 17.2.3 pour variables d'environnement
- **Migrations**: Prisma Migrate
- **Client singleton**: `/lib/prisma.ts` pour r√©utilisation globale

---

## üé® Design System & Guidelines

### Tokens s√©mantiques (OBLIGATOIRE)
- **R√àGLE ABSOLUE** : Utiliser exclusivement les tokens s√©mantiques pour toutes les couleurs
- **Interdiction formelle** : Classes Tailwind directes (`bg-white`, `text-black`, `bg-gray-100`, etc.)

#### Background tokens
- `bg-background-100` : Main background (blanc/noir profond)
- `bg-background-200` : Subtle background  
- `bg-background-300` : Cards, sections principales
- `bg-background-400` : Hover states, interactions
- `bg-background-500` : Borders, dividers

#### Foreground tokens
- `text-foreground-100` : Disabled text
- `text-foreground-200` : Placeholder text
- `text-foreground-300` : Secondary text
- `text-foreground-400` : Tertiary text
- `text-foreground-500` : Body text (standard)
- `text-foreground-600` : Headings
- `text-foreground-700` : Emphasis text
- `text-foreground-800` : Primary text
- `text-foreground-900` : High contrast

### Composants UI (shadcn/ui PRIORIT√â ABSOLUE)
- **Principe** : Toujours utiliser shadcn/ui avant toute autre solution
- **Composants install√©s** : Button, Input, Card, Dialog, Form, Badge, Progress, Calendar, Switch, Tabs, Toast (Sonner), Avatar, Sheet
- **Personnalisation** : Via variants et CSS variables uniquement
- **Accessibilit√©** : Int√©gr√©e par d√©faut dans tous les composants

Si besoin install√© d'autre composants Radix UI via shadcn/ui.

### Patterns de navigation responsive
**Navigation mobile avec menu burger** : Pattern standard pour l'approche mobile-first

#### Structure recommand√©e
```typescript
'use client' // N√©cessaire pour useState + event handlers

export function ResponsiveNav() {
  const [isOpen, setIsOpen] = useState(false)
  
  return (
    <nav>
      {/* Desktop: Navigation visible */}
      <div className="hidden md:flex">
        {/* Liens de navigation */}
      </div>
      
      {/* Mobile: Menu burger avec Sheet */}
      <div className="md:hidden">
        <Sheet open={isOpen} onOpenChange={setIsOpen}>
          <SheetTrigger asChild>
            <Button variant="ghost" size="icon">
              <Menu className="h-6 w-6" />
            </Button>
          </SheetTrigger>
          <SheetContent side="right">
            {/* Contenu du menu mobile */}
            <Link onClick={() => setIsOpen(false)}>...</Link>
          </SheetContent>
        </Sheet>
      </div>
    </nav>
  )
}
```

#### Bonnes pratiques navigation
- **Composant Sheet** : Utiliser pour menus mobiles (panneau lat√©ral)
- **Breakpoint standard** : `md:` (768px) pour basculer desktop/mobile
- **Fermeture auto** : `onClick={() => setIsOpen(false)}` sur les liens
- **Accessibilit√©** : 
  - `<span className="sr-only">` pour texte lecteurs d'√©cran
  - `asChild` sur SheetTrigger pour √©viter nested buttons
- **Ic√¥nes** : Menu (burger), X (fermeture) de Lucide React
- **Justification 'use client'** : Menu n√©cessite `useState` pour g√©rer l'√©tat ouvert/ferm√© + `onClick` handlers

#### Exemple complet (LandingNav)
```typescript
'use client' // ‚úÖ Justifi√© : useState + onClick handlers

import { useState } from "react"
import { Menu } from "lucide-react"
import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet"

export function LandingNav() {
  const [isOpen, setIsOpen] = useState(false) // √âtat du menu
  
  return (
    <nav className="bg-background-200 border-b border-background-500">
      {/* Logo toujours visible */}
      <div className="flex items-center justify-between">
        <Logo />
        
        {/* Desktop: boutons visibles */}
        <div className="hidden md:flex gap-4">
          <Button>Se connecter</Button>
        </div>
        
        {/* Mobile: burger menu */}
        <div className="md:hidden">
          <Sheet open={isOpen} onOpenChange={setIsOpen}>
            <SheetTrigger asChild>
              <Button variant="ghost" size="icon">
                <Menu className="h-6 w-6" />
                <span className="sr-only">Ouvrir le menu</span>
              </Button>
            </SheetTrigger>
            <SheetContent side="right" className="bg-background-200">
              <div className="flex flex-col gap-4">
                <Link onClick={() => setIsOpen(false)}>
                  <Button className="w-full">Se connecter</Button>
                </Link>
              </div>
            </SheetContent>
          </Sheet>
        </div>
      </div>
    </nav>
  )
}
```

---

## üì± Approche d√©veloppement

### Mobile-First (OBLIGATOIRE)
- Conception mobile d'abord (320px+)
- Breakpoints responsive : mobile (320px), tablet (768px), desktop (1024px)
- Interactions tactiles optimis√©es
- Performance mobile prioritaire

### Architecture des pages
```
/ - Landing page / connexion rapide
/login - Connexion utilisateur  
/register - Inscription utilisateur
/dashboard - Vue principale (stats, liste d'habitudes)
/habits/[id] - D√©tail d'une habitude
/account - Profil et r√©glages
```

---

## üèÜ Roadmap de d√©veloppement

### Version 1 - MVP (Priorit√© absolue)
1. **Authentification** : NextAuth.js - Inscription/connexion/session/protection routes
2. **Gestion habitudes** : CRUD habitudes avec fr√©quences et validation
3. **Dashboard** : Vue calendrier + liste du jour
4. **Streaks** : Suivi des s√©ries de r√©ussite

### Version 2 - Am√©liorations
- Personnalisation (ic√¥nes, couleurs, cat√©gories)
- Mode sombre/clair (next-themes)
- Page d√©tail habitude
- Export donn√©es

### Version 3 - Avanc√©
- Notifications intelligentes
- Statistiques avanc√©es
- Graphiques de progression

---

## üß© Guidelines techniques

### Conventions de code
- **TypeScript** : Mode strict activ√©
- **Composants** : React fonctionnels avec hooks uniquement
- **Nommage** : camelCase (JS/TS), kebab-case (CSS)
- **Structure** : Modulaire et r√©utilisable
- **Documentation** : Commentaires pour logique complexe

### Architecture Client/Server Components (CRITIQUE)
> **R√àGLE FONDAMENTALE** : Chaque choix entre Client et Server Component doit √™tre **justifi√© et justifiable logiquement**.

#### üñ•Ô∏è Server Components (par d√©faut)
**Utiliser TOUJOURS par d√©faut**, sauf si besoin explicite d'interactivit√© client.

**Quand utiliser** :
- ‚úÖ R√©cup√©ration de donn√©es depuis la BDD (Prisma)
- ‚úÖ Acc√®s aux secrets/variables serveur
- ‚úÖ Composants purement statiques (sans interactivit√©)
- ‚úÖ Op√©rations lourdes c√¥t√© serveur
- ‚úÖ R√©duction du bundle JavaScript client

**Exemples justifi√©s** :
```typescript
// ‚úÖ Server Component - R√©cup√®re des donn√©es
export default async function HabitsList({ userId }: { userId: string }) {
  const habits = await prisma.habit.findMany({ where: { userId } })
  return <div>{habits.map(h => <HabitCard key={h.id} habit={h} />)}</div>
}

// ‚úÖ Server Component - Layout statique
export default function DashboardLayout({ children }: { children: React.ReactNode }) {
  return <div className="container">{children}</div>
}
```

#### üíª Client Components ('use client')
**Utiliser UNIQUEMENT quand n√©cessaire** - Doit √™tre justifiable.

**Quand utiliser** :
- ‚úÖ Hooks React (useState, useEffect, useContext, etc.)
- ‚úÖ Event handlers (onClick, onChange, onSubmit, etc.)
- ‚úÖ Interactions utilisateur (hover, focus, animations)
- ‚úÖ APIs navigateur (localStorage, window, document)
- ‚úÖ Composants shadcn/ui avec interactivit√© (Dialog, Form, Switch, etc.)

**Exemples justifi√©s** :
```typescript
// ‚úÖ Client Component - Utilise useState + onClick
'use client'
export function HabitToggle({ habitId }: { habitId: string }) {
  const [completed, setCompleted] = useState(false)
  
  const handleToggle = async () => {
    // Logique d'interaction
    setCompleted(!completed)
  }
  
  return <button onClick={handleToggle}>Toggle</button>
}

// ‚úÖ Client Component - Formulaire avec validation
'use client'
export function CreateHabitForm() {
  const form = useForm() // Hook React Hook Form
  return <form onSubmit={form.handleSubmit(onSubmit)}>...</form>
}
```

#### üîÄ Pattern de composition recommand√©
**Maximiser Server, minimiser Client** - Encapsuler le client dans le serveur.

```typescript
// ‚úÖ EXCELLENT - Server Component parent
export default async function HabitsPage() {
  const habits = await getHabits() // Fetch c√¥t√© serveur
  
  return (
    <div>
      <HabitsHeader /> {/* Server Component */}
      <HabitsList habits={habits}> {/* Server Component */}
        {habits.map(habit => (
          <HabitCard key={habit.id} habit={habit}> {/* Server */}
            <HabitToggleButton habitId={habit.id} /> {/* Client uniquement ici */}
          </HabitCard>
        ))}
      </HabitsList>
    </div>
  )
}
```

#### ‚ö†Ô∏è Erreurs courantes √† √©viter
```typescript
// ‚ùå MAUVAIS - Tout en Client alors que pas n√©cessaire
'use client'
export default function Dashboard() { // Pas de hooks = pas besoin de client
  return <div>Static content</div>
}

// ‚ùå MAUVAIS - Fetch dans Client Component
'use client'
export function HabitsList() {
  const [habits, setHabits] = useState([])
  useEffect(() => {
    fetch('/api/habits').then(r => r.json()).then(setHabits) // ‚ùå
  }, [])
}

// ‚úÖ BON - Fetch dans Server Component
export default async function HabitsList() {
  const habits = await prisma.habit.findMany() // ‚úÖ
  return <div>{habits.map(...)}</div>
}
```

#### üìã Checklist de d√©cision

Avant de choisir Client Component, v√©rifier :
1. ‚ùì Ai-je besoin de hooks React ? ‚Üí Oui = Client
2. ‚ùì Ai-je besoin d'event handlers ? ‚Üí Oui = Client
3. ‚ùì Ai-je besoin d'APIs navigateur ? ‚Üí Oui = Client
4. ‚ùì Le composant est-il purement statique ? ‚Üí Oui = Server
5. ‚ùì Puis-je isoler l'interactivit√© dans un sous-composant ? ‚Üí Oui = Faire √ßa

#### üéØ R√®gles d'or
- **Par d√©faut = Server** : Ne pas ajouter 'use client' sans raison
- **Justification obligatoire** : Tout Client Component doit avoir une raison document√©e
- **Granularit√©** : Client Components aussi petits que possible
- **Composition** : Server parent ‚Üí Client enfant isol√©
- **Performance** : Moins de JavaScript client = app plus rapide

### Structure des Skeletons
```
components/Skeletons/
‚îú‚îÄ‚îÄ base/          # Atomiques (SkeletonCard, SkeletonText, etc.)
‚îú‚îÄ‚îÄ composed/      # Compos√©s (SkeletonHabitCard, SkeletonStatCard)
‚îî‚îÄ‚îÄ pages/         # Pages compl√®tes (SkeletonDashboard, etc.)
```

### Bonnes pratiques
- **Performance** : SSR, optimisation images, lazy loading
- **Accessibilit√©** : a11y pour tous les utilisateurs
- **Progressive Web App** : PWA compatible
- **Loading states** : Feedback utilisateur constant
- **Gestion erreurs** : Gracieuse avec Toast (Sonner) notifications
- **SEO** : Meta tags dynamiques, sitemaps
- **Respect de nextjs** : Suivre les conventions et optimisations recommand√©es par la documentation officielle pour cette version

---

## üîí S√©curit√© & Architecture

### Authentification
- **NextAuth.js** : Sessions s√©curis√©es
- **Protection routes** : Middleware pour pages priv√©es
- **Validation** : Client ET serveur (Zod)
- **Isolation donn√©es** : Par utilisateur

### Standards qualit√©
- **ESLint** : Configuration Next.js stricte
- **TypeScript** : Types stricts, pas de `any`
- **Performance** : Core Web Vitals optimis√©s
- **Tests** : √Ä impl√©menter (Jest + Testing Library)

---

## üí° Rappels critiques

### ‚úÖ √Ä TOUJOURS faire
- Tester sur mobile en premier
- Utiliser shadcn/ui exclusivement
- Appliquer les tokens s√©mantiques pour toutes les couleurs
- **Justifier chaque choix Client/Server Component**
- **Privil√©gier Server Components par d√©faut**
- Suivre les priorit√©s MVP
- Optimiser pour les interactions tactiles
- Maintenir l'interface simple et motivante
- Documenter le code
- Respecter les conventions Next.js

### ‚ùå √Ä JAMAIS faire
- Utiliser des classes de couleur Tailwind directes
- Impl√©menter des composants UI custom sans v√©rifier shadcn/ui
- **Ajouter 'use client' sans justification logique claire**
- **Faire du fetching de donn√©es dans des Client Components**
- **Mettre tout en Client Component par paresse**
- Ignorer l'approche mobile-first
- Ajouter des fonctionnalit√©s avanc√©es avant le MVP
- Utiliser `any` en TypeScript

---

## üìö Inspiration design
- **Simplicit√©** : Streaks app (motivation par s√©ries)
- **Productivit√©** : Habitify app (suivi d√©taill√©)
- **Interface** : √âpur√©e, motivante, indicateurs visuels clairs

---

## üîÑ Extensions futures
*Section r√©serv√©e pour les ajouts futurs*
- Authentification OAuth
- Int√©grations tierces
- Analytics avanc√©es
- Notifications push